# 3-1

```sql
SELECT COUNT(*) FROM Shohin;

SELECT COUNT(shiire_tanka) FROM Shohin;


-- 重複値を省いてカウント
SELECT COUNT(DISTINCT shohin_bunrui) FROM Shohin;

-- COUNTの実効値の重複を削除
SELECT DISTINCT COUNT(shohin_bunrui) FROM Shohin;
```

- COUNT の特殊な仕様
  - COUNT(\*)→NULL をカウントする
    - 単にテーブルの行数を数える
  - COUNT(row_name)→NULL をカウントしない
    - 値のある列を数える

```sql
SELECT SUM(hanbai_tanka)
FROM Shohin;

SELECT SUM(hanbai_tanka), SUM(shiire_tanka)
FROM Shohin;
SELECT AVG(hanbai_tanka), AVG(shiire_tanka)
FROM Shohin;

SELECT MAX(hanbai_tanka), MIN(shiire_tanka)
FROM Shohin;

SELECT SUM(hanbai_tanka), SUM(DISTINCT hanbai_tanka)
FROM Shohin;
```

- SUM、AVG 関数において NULL は 0 という扱いになる
- DISTINCT は集約関数全般につけることができる

# 3-2

```sql
SELECT shohin_bunrui, COUNT(*)
FROM Shohin
GROUP BY shohin_bunrui;

SELECT shiire_tanka, COUNT(*)
FROM Shohin
GROUP BY shiire_tanka;

SELECT shiire_tanka, COUNT(*)
FROM Shohin
WHERE shohin_bunrui = '衣服'
GROUP BY shiire_tanka;

SELECT shohin_mei, shiire_tanka, COUNT(*)
FROM Shohin
GROUP BY shiire_tanka;
```

- 集約キーに NULL が含まれる場合、NULL グループとして扱われる
- 実行順序
  - FROM → WHERE → GROUP BY → SELECT
- GROUP BY に指定したキー以外の項目を SELECT に入れることはできない。
  - なぜなら GROUP BY によって絞り込まれた結果に対して、他の項目が複数パターンある場合があるから
  - １セルには複数の値を表示できない。
  - 解決方法として、代表値を決めたり、サブクエリを使用したりする
