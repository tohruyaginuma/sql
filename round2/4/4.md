# 4

## 4-1 INSERT

```sql
CREATE TABLE ShohinIns (
    shohin_id CHAR(4) NOT NULL,
    shohin_mei VARCHAR(100) NOT NULL,
    shohin_bunrui VARCHAR(32) NOT NULL,
    hanabai_tanka INTEGER DEFAULT 0,
    shiire_tanka INTEGER ,
    torokubi DATE ,
    PRIMARY KEY (shohin_id)
);

ALTER TABLE ShohinIns RENAME COLUMN hanabai_tanka TO hanbai_tanka;
ALTER TABLE ShohinIns ALTER COLUMN torokubi TYPE DATE USING NULL::date;

INSERT INTO ShohinIns (
    shohin_id,
    shohin_mei,
    shohin_bunrui,
    hanbai_tanka,
    shiire_tanka,
    torokubi
) VALUES (
    '0001',
    'Tシャツ',
    '衣服',
    1000,
    500,
    '2009-09-20'
);

-- 複数業インサート
INSERT INTO ShohinIns VALUES ('0002', '穴あけパンチ', '事務用品', 500, 320, '2009-09-11'),
('0003', 'カッターシャツ', '衣服', 4000, 2800, NULL),
('0004', '包丁', 'キッチン用品', 2000, 2800, '2009-09-20');

-- 列リストなしインサート
INSERT INTO ShohinIns VALUES ('0005',  '圧力鍋', 'キッチン用品', 6800, 5000, '2009=01-15');

INSERT INTO ShohinIns (shohin_id, shohin_mei, shohin_bunrui, hanbai_tanka, shiire_tanka, torokubi) VALUES (
    '0007', 'おろしがね', 'キッチン用品', DEFAULT , 790, '2009-04-28'
);
```

```sql
-- 他のテーブルからコピー
CREATE TABLE ShohinCopy (
    shohin_id   CHAR(4) NOT NULL,
    shohin_mei   VARCHAR(100) NOT NULL,
    shohin_bunrui   VARCHAR(32) NOT NULL,
    hanbai_tanka    INTEGER ,
    shiire_tanka    INTEGER ,
    torokubi    DATE ,
    PRIMARY KEY (shohin_id)
);

ALTER TABLE ShohinCopy RENAME shohin_buruin TO shohin_bunrui;

-- 商品テーブルのデータを商品コピーテーブル
-- INSERT - SELECT
-- VIEW テーブルの実態作るバージョン的な
INSERT INTO ShohinCopy (
    shohin_id, shohin_mei, shohin_bunrui, hanbai_tanka, shiire_tanka, torokubi
) SELECT shohin_id, shohin_mei, shohin_bunrui, hanbai_tanka, shiire_tanka, torokubi FROM Shohin;

DELETE FROM Shohin WHERE hanbai_tanka >= 4000;

UPDATE Shohin SET torokubi = '2009-10-10';

UPDATE Shohin
SET hanbai_tanka = hanbai_tanka * 10
WHERE shohin_bunrui = 'キッチン用品';

UPDATE Shohin SET torokubi = NULL WHERE shohin_id = '0008';

-- 複数行のアップデート
UPDATE Shohin
SET hanbai_tanka = hanbai_tanka * 10,
shiire_tanka = shiire_tanka / 2
WHERE shohin_bunrui = 'キッチン用品';

UPDATE Shohin
SET (hanbai_tanka, shiire_tanka) = (hanbai_tanka * 10, shiire_tanka / 2)
WHERE shohin_bunrui = 'キッチン用品';
```

- トランザクションとは、セットで実行されるべき１つ以上の更新処理の集まりのこと